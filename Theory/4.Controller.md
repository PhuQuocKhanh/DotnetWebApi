-- Controller trong ASP.NET Core Web API là gì? --
- Controller là thành phần cốt lõi trong các ứng dụng ASP.NET Core Web API. 
- Chúng là các lớp chịu trách nhiệm xử lý các HTTP request đến, thực thi logic và trả về HTTP response phù hợp. 
- Controller đóng vai trò trung gian giữa client và server, xử lý yêu cầu, thực thi nghiệp vụ và trả về dữ liệu dưới dạng JSON, XML,... Tuân thủ các nguyên tắc REST, Controller quản lý luồng dữ liệu giữa client và server.
- Vai trò chính của Controller:
  1. Xử lý Request:
    - Nhận HTTP request và định tuyến đến các action method tương ứng.
    - Mỗi action method thường tương ứng với một loại HTTP request (GET, POST, PUT, DELETE).
  2. Xử lý dữ liệu:
    - Tương tác với Model và Service để thực thi nghiệp vụ: truy vấn CSDL (CRUD), áp dụng rules/validation, hoặc chuyển đổi dữ liệu trước khi trả về client.
  3. Tạo Response:
    - Trả về HTTP response bao gồm: dữ liệu (JSON/XML), status code (200 OK, 404 Not Found, 400 Bad Request,...) hoặc thông báo lỗi.

-- Adding Controller Class in ASP.NET Core Web API -- 
- Khi tạo một controller trong dự án ASP.NET Core Web API, hãy tuân thủ các quy ước và phương pháp tốt nhất sau đây:
  1. Quy ước đặt tên:
    - Theo quy ước, ASP.NET Core nhận diện các lớp controller có tên kết thúc bằng hậu tố "Controller".
    - Do đó, tên lớp controller bắt buộc phải có hậu tố "Controller". Ví dụ:
    - Một controller quản lý Employee nên được đặt tên là EmployeeController.
    - Một controller xử lý sinh viên nên được đặt tên là StudentController.
  2. Lớp cơ sở:
    - Các controller trong ASP.NET Core Web API thường kế thừa từ lớp ControllerBase, cung cấp các phương thức và thuộc tính cần thiết để xử lý các yêu cầu HTTP và tạo phản hồi mà không cần hỗ trợ view.
    - Nếu cần hiển thị view phía máy chủ (server-side rendering), hãy sử dụng lớp Controller thay vì ControllerBase. 
    - Lớp Controller kế thừa từ lớp ControllerBase.
- Cấu trúc thư mục được khuyến nghị:
- Các controller nên được đặt trong thư mục Controllers của dự án. Nếu thư mục này chưa tồn tại, hãy tạo nó trong thư mục gốc để duy trì cấu trúc dự án gọn gàng và tổ chức tốt.

-- Understanding the Different Options: --
- Hãy cùng tìm hiểu các tùy chọn để tạo API Controller trong ASP.NET Core:
  1. API Controller – Empty
    - Mẫu này tạo một lớp API controller cơ bản không có các action được định nghĩa sẵn. 
    - Nó phù hợp khi bạn muốn kiểm soát hoàn toàn việc định nghĩa các action và endpoint của riêng mình. 
    - Chúng ta sử dụng mẫu này khi muốn tự định nghĩa tất cả các thao tác CRUD và các HTTP verb tương ứng (GET, POST, PUT, DELETE). Nó bắt đầu với một lớp controller trống mà chúng ta cần điền vào các action mong muốn.
  2. API Controller with Read/Write Actions
    - Mẫu này tạo ra các action CRUD cơ bản (ví dụ: Get, Post, Put, Delete). 
    - Bạn nên sử dụng mẫu này khi muốn thiết lập nhanh một RESTful controller tiêu chuẩn mà không cần logic tùy chỉnh. 
    - Nó thiết lập sẵn các action để liệt kê tất cả tài nguyên, truy xuất tài nguyên theo ID, tạo mới tài nguyên, cập nhật tài nguyên hiện có và xóa tài nguyên.
  3. API Controller with Actions Using Entity Framework
    - Mẫu này mở rộng từ "API Controller with Read/Write Actions" bằng cách tích hợp Entity Framework Core để tương tác với cơ sở dữ liệu. 
    - Bạn nên sử dụng mẫu này khi controller của bạn trực tiếp làm việc với cơ sở dữ liệu để thực hiện các thao tác CRUD cơ bản trên các entity.
  4. API with Read/Write Endpoints
    - Tương tự như mẫu "API Controller with Read/Write Actions", nhưng cho phép linh hoạt hơn trong việc tùy chỉnh tên endpoint và HTTP verb.
    - Bạn nên sử dụng mẫu này khi cần kiểm soát nhiều hơn về cách đặt tên endpoint hoặc muốn thêm các action ngoài các thao tác CRUD cơ bản.
  5. API Controller with Read/Write Endpoints Using Entity Framework
    - Kết hợp tích hợp cơ sở dữ liệu với khả năng tùy chỉnh tên endpoint.
    - Bạn nên sử dụng mẫu này khi cần cả tích hợp cơ sở dữ liệu (thông qua EF Core) và tùy chỉnh tên endpoint.

-- Difference Between the Controller and ControllerBase class in ASP.NET Core: -- 
- Trong ASP.NET Core, cả hai lớp Controller và ControllerBase đều đóng vai trò là lớp cơ sở cho các controller, nhưng chúng được thiết kế cho các trường hợp khác nhau và cung cấp các tính năng cùng bộ chức năng khác biệt.

1. Lớp ControllerBase trong ASP.NET Core
- Đây là lớp cơ sở nhẹ dành cho các controller Web API không yêu cầu hỗ trợ view. Dưới đây là một số Tính Năng Chính của Lớp ControllerBase:
  1. Tính năng MVC cốt lõi: Cung cấp quyền truy cập vào các chức năng cơ bản như phương thức action, định tuyến, liên kết mô hình (model binding) và thao tác với HTTP context.
  2. Không hỗ trợ View: Không bao gồm hỗ trợ hiển thị view (ví dụ: HTML hoặc Razor views), phù hợp cho các API chỉ trả về dữ liệu. 
  3. Phương thức trợ giúp: Cung cấp các phương thức như Ok(), NotFound(), BadRequest(),... để tạo phản hồi HTTP tiêu chuẩn.
  4. Nhẹ: Loại bỏ chi phí liên quan đến hiển thị view, giúp cải thiện hiệu suất cho các endpoint API.
  5. Trường hợp sử dụng: Xây dựng RESTful API trả về dữ liệu dưới dạng JSON hoặc XML mà không cần hiển thị view phía máy chủ.
2. Lớp Controller trong ASP.NET Core
- Lớp này mở rộng từ ControllerBase bằng cách thêm hỗ trợ các chức năng liên quan đến view, phù hợp cho ứng dụng MVC cần hiển thị view phía máy chủ. 
- Nó hỗ trợ tất cả tính năng của ControllerBase cùng các tính năng bổ sung dành riêng cho ứng dụng MVC. 
- Dưới đây là một số Tính Năng Chính của Lớp Controller:
  - Tất cả tính năng của ControllerBase: Kế thừa mọi chức năng cốt lõi từ ControllerBase.
  - Hỗ trợ View: Bao gồm các phương thức và thuộc tính để hiển thị view như View(), PartialView(), cùng quyền truy cập vào ViewBag và ViewData.
  - Chức năng bổ sung: Cung cấp khả năng quản lý và hiển thị HTML view sử dụng cú pháp Razor.
  - Trường hợp sử dụng: Phát triển ứng dụng MVC truyền thống, nơi controller xử lý cả endpoint dữ liệu và hiển thị view phía máy chủ.

- Lựa Chọn Giữa Controller và ControllerBase trong ASP.NET Core
- Khi quyết định kế thừa từ lớp cơ sở nào, hãy xem xét trách nhiệm chính của controller:
  1. Sử dụng ControllerBase Khi:
    - Xây dựng Web API tập trung vào xử lý HTTP request và trả về dữ liệu.
    - Không cần hỗ trợ hoặc hiển thị view phía máy chủ.
    - Mục tiêu là giữ dự án nhẹ và tối ưu cho các endpoint hướng dữ liệu.
  1.  Sử dụng Controller Khi:
    - Phát triển ứng dụng MVC yêu cầu hiển thị view phía máy chủ. 
    - Controller cần xử lý cả thao tác dữ liệu và hiển thị view.
    - Cần sử dụng các tính năng liên quan đến view như ViewBag, ViewData và Razor views.
- Controller là trái tim của Web API trong ASP.NET Core, xử lý HTTP request, thực thi logic nghiệp vụ và tạo phản hồi. 
- Việc định tuyến hợp lý, phương thức action và sử dụng [ApiController] giúp tăng cường chức năng, khả năng bảo trì và hiệu suất của API.